{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\mrgil\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\Coincap\\\\Coin\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from'react';import{CoinBlock}from'./components/CoinList';import{Header}from'./components/CoinsHeader';import{Pagination}from'./components/Pagination';import{sortCoins}from'../../utilities/sortCoins';import getInfo from'../../API/api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListPage(_ref){var searchText=_ref.searchText,coinsPerPage=_ref.coinsPerPage,rate=_ref.rate;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),currentCoins=_useState4[0],setCurrentCoins=_useState4[1];var _useState5=useState(2000),_useState6=_slicedToArray(_useState5,2),totalCoins=_useState6[0],setTotalCoins=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),time=_useState8[0],setTime=_useState8[1];var _useState9=useState(200),_useState10=_slicedToArray(_useState9,2),totalPages=_useState10[0],setTotalPages=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),sortName=_useState12[0],setSortName=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),allCoins=_useState14[0],setAllCoins=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),sortedCoins=_useState16[0],setSortedCoins=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),visiblePagesFromCurrentPage=_useState18[0],setVisiblePagesFromCurrentPage=_useState18[1];var _useState19=useState(3),_useState20=_slicedToArray(_useState19,2),visiblePagesFromThеEdges=_useState20[0],setVisiblePagesFromThеEdges=_useState20[1];var pagination=function pagination(pageNamber){return setCurrentPage(pageNamber);};var sort=function sort(name){return setSortName(name);};var firstCoinsIndex=currentPage*coinsPerPage-coinsPerPage;var lastCoinsIndex=firstCoinsIndex+coinsPerPage;var screenWidth=window.screen.width;useEffect(function(){if(screenWidth>960){setVisiblePagesFromCurrentPage(8);setVisiblePagesFromThеEdges(20);}},[screenWidth]);useEffect(function(){var update=function update(){setTime(function(prevTime){return prevTime+1;});setTimeout(update,10000);};update();},[]);useEffect(function(){setTotalPages(Math.ceil(totalCoins/coinsPerPage));},[totalCoins,coinsPerPage]);useEffect(function(){var getAllCoins=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getInfo('assets/?limit=2000');case 2:response=_context.sent;setAllCoins(response);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getAllCoins(){return _ref2.apply(this,arguments);};}();getAllCoins();},[time]);useEffect(function(){var getCoins=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,responseCount;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!searchText.length){_context2.next=10;break;}_context2.next=3;return getInfo(\"assets/?search=\".concat(searchText,\"&limit=2000\"));case 3:responseCount=_context2.sent;_context2.next=6;return getInfo(\"assets/?offset=\".concat(firstCoinsIndex,\"&limit=\").concat(coinsPerPage,\"&search=\").concat(searchText));case 6:response=_context2.sent;setTotalCoins(responseCount.length);_context2.next=16;break;case 10:if(!sortedCoins.length){_context2.next=12;break;}return _context2.abrupt(\"return\");case 12:_context2.next=14;return getInfo(\"assets/?offset=\".concat(firstCoinsIndex,\"&limit=\").concat(coinsPerPage));case 14:response=_context2.sent;setTotalCoins(2000);case 16:setCurrentCoins(response);case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function getCoins(){return _ref3.apply(this,arguments);};}();getCoins();},[coinsPerPage,time,currentPage,searchText,rate,sortedCoins.length,firstCoinsIndex]);useEffect(function(){if(sortName)setSortedCoins(sortCoins(sortName,allCoins));},[sortName,allCoins]);useEffect(function(){if(searchText.length||!sortedCoins.length)return;setCurrentCoins(sortedCoins.slice(firstCoinsIndex,lastCoinsIndex));},[sortedCoins,searchText,firstCoinsIndex,lastCoinsIndex]);return/*#__PURE__*/_jsxs(\"div\",{className:\"list-page\",children:[/*#__PURE__*/_jsx(Header,{sort:sort}),/*#__PURE__*/_jsx(CoinBlock,{coins:currentCoins,rate:rate}),/*#__PURE__*/_jsx(Pagination,{totalPages:totalPages,visiblePagesFromCurrentPage:visiblePagesFromCurrentPage,visiblePagesFromThеEdges:visiblePagesFromThеEdges,pagination:pagination})]});}export default ListPage;","map":{"version":3,"sources":["C:/Users/mrgil/OneDrive/Рабочий стол/Coincap/Coin/src/Main/LitsPage/CoinsPage.jsx"],"names":["React","useEffect","useState","CoinBlock","Header","Pagination","sortCoins","getInfo","ListPage","searchText","coinsPerPage","rate","currentPage","setCurrentPage","currentCoins","setCurrentCoins","totalCoins","setTotalCoins","time","setTime","totalPages","setTotalPages","sortName","setSortName","allCoins","setAllCoins","sortedCoins","setSortedCoins","visiblePagesFromCurrentPage","setVisiblePagesFromCurrentPage","visiblePagesFromThеEdges","setVisiblePagesFromThеEdges","pagination","pageNamber","sort","name","firstCoinsIndex","lastCoinsIndex","screenWidth","window","screen","width","update","prevTime","setTimeout","Math","ceil","getAllCoins","response","getCoins","length","responseCount","slice"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { CoinBlock } from './components/CoinList';\r\nimport { Header } from './components/CoinsHeader';\r\nimport { Pagination } from './components/Pagination';\r\nimport { sortCoins } from '../../utilities/sortCoins';\r\nimport getInfo from '../../API/api';\r\n\r\nfunction ListPage({ searchText, coinsPerPage, rate }) {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [currentCoins, setCurrentCoins] = useState([]);\r\n  const [totalCoins, setTotalCoins] = useState(2000);\r\n  const [time, setTime] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(200);\r\n  const [sortName, setSortName] = useState('');\r\n  const [allCoins, setAllCoins] = useState(0);\r\n  const [sortedCoins, setSortedCoins] = useState([]);\r\n  const [visiblePagesFromCurrentPage, setVisiblePagesFromCurrentPage] = useState(1);\r\n  const [visiblePagesFromThеEdges, setVisiblePagesFromThеEdges] = useState(3);\r\n\r\n  const pagination = (pageNamber) => setCurrentPage(pageNamber);\r\n\r\n  const sort = (name) => setSortName(name);\r\n\r\n  const firstCoinsIndex = (currentPage * coinsPerPage) - coinsPerPage;\r\n  const lastCoinsIndex = firstCoinsIndex + coinsPerPage;\r\n\r\n  const screenWidth = window.screen.width;\r\n\r\n  useEffect(() => {\r\n    if (screenWidth > 960) {\r\n      setVisiblePagesFromCurrentPage(8);\r\n      setVisiblePagesFromThеEdges(20);\r\n    }\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    const update = () => {\r\n      setTime((prevTime) => prevTime + 1);\r\n      setTimeout(update, 10000);\r\n    };\r\n    update();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setTotalPages(Math.ceil(totalCoins / coinsPerPage));\r\n  }, [totalCoins, coinsPerPage]);\r\n\r\n  useEffect(() => {\r\n    const getAllCoins = async () => {\r\n      const response = await getInfo('assets/?limit=2000');\r\n      setAllCoins(response);\r\n    };\r\n    getAllCoins();\r\n  }, [time]);\r\n\r\n  useEffect(() => {\r\n    const getCoins = async () => {\r\n      let response;\r\n      if (searchText.length) {\r\n        const responseCount = await getInfo(`assets/?search=${searchText}&limit=2000`);\r\n        response = await getInfo(`assets/?offset=${firstCoinsIndex}&limit=${coinsPerPage}&search=${searchText}`);\r\n        setTotalCoins(responseCount.length);\r\n      } else {\r\n        if (sortedCoins.length) return;\r\n        response = await getInfo(`assets/?offset=${firstCoinsIndex}&limit=${coinsPerPage}`);\r\n        setTotalCoins(2000);\r\n      }\r\n      setCurrentCoins(response);\r\n    };\r\n    getCoins();\r\n  }, [coinsPerPage, time, currentPage, searchText, rate, sortedCoins.length, firstCoinsIndex]);\r\n\r\n  useEffect(() => {\r\n    if (sortName) setSortedCoins(sortCoins(sortName, allCoins));\r\n  }, [sortName, allCoins]);\r\n\r\n  useEffect(() => {\r\n    if (searchText.length || !sortedCoins.length) return;\r\n    setCurrentCoins(sortedCoins.slice(firstCoinsIndex, lastCoinsIndex));\r\n  }, [sortedCoins, searchText, firstCoinsIndex, lastCoinsIndex]);\r\n\r\n  return (\r\n    <div className=\"list-page\">\r\n      <Header sort={sort} />\r\n      <CoinBlock coins={currentCoins} rate={rate} />\r\n      <Pagination\r\n        totalPages={totalPages}\r\n        visiblePagesFromCurrentPage={visiblePagesFromCurrentPage}\r\n        visiblePagesFromThеEdges={visiblePagesFromThеEdges}\r\n        pagination={pagination}\r\n      />\r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default ListPage;\r\n"]},"metadata":{},"sourceType":"module"}