{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\mrgil\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\Coincap\\\\Coin\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from'react';import CoinBlock from'../../Components/ListPageComponents/CoinBlock';import Header from'../../Components/ListPageComponents/Header';import Pagination from'../../Components/ListPageComponents/Pagination';import{sortCoins}from'../../utilities/sortCoins';import getInfo from'../../API/api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListPage(_ref){var searchText=_ref.searchText,coinsPerPage=_ref.coinsPerPage,rate=_ref.rate;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),currentCoins=_useState4[0],setCurrentCoins=_useState4[1];var _useState5=useState(2000),_useState6=_slicedToArray(_useState5,2),totalCoins=_useState6[0],setTotalCoins=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),time=_useState8[0],setTime=_useState8[1];var _useState9=useState(200),_useState10=_slicedToArray(_useState9,2),totalPages=_useState10[0],setTotalPages=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),sortName=_useState12[0],setSortName=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),allCoins=_useState14[0],setAllCoins=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),sortedCoins=_useState16[0],setSortedCoins=_useState16[1];var pagination=function pagination(pageNamber){return setCurrentPage(pageNamber);};var sort=function sort(name){return setSortName(name);};var firstCoinsIndex=currentPage*coinsPerPage-coinsPerPage;var lastCoinsIndex=firstCoinsIndex+coinsPerPage;useEffect(function(){var update=function update(){setTime(function(prevTime){return prevTime+1;});setTimeout(update,10000);};update();},[]);useEffect(function(){setTotalPages(Math.ceil(totalCoins/coinsPerPage));},[totalCoins,coinsPerPage]);useEffect(function(){var getAllCoins=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getInfo('assets/?limit=2000');case 2:response=_context.sent;setAllCoins(response);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getAllCoins(){return _ref2.apply(this,arguments);};}();getAllCoins();},[time]);useEffect(function(){var getCoins=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,responseCount;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(searchText.length!==0)){_context2.next=10;break;}_context2.next=3;return getInfo(\"assets/?search=\".concat(searchText,\"&limit=2000\"));case 3:responseCount=_context2.sent;_context2.next=6;return getInfo(\"assets/?offset=\".concat(firstCoinsIndex,\"&limit=\").concat(coinsPerPage,\"&search=\").concat(searchText));case 6:response=_context2.sent;setTotalCoins(responseCount.length);_context2.next=16;break;case 10:if(!(sortedCoins.length!==0)){_context2.next=12;break;}return _context2.abrupt(\"return\");case 12:_context2.next=14;return getInfo(\"assets/?offset=\".concat(firstCoinsIndex,\"&limit=\").concat(coinsPerPage));case 14:response=_context2.sent;setTotalCoins(2000);case 16:setCurrentCoins(response);case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function getCoins(){return _ref3.apply(this,arguments);};}();getCoins();},[coinsPerPage,time,currentPage,searchText,rate,sortedCoins.length]);useEffect(function(){if(sortName!=='')setSortedCoins(sortCoins(sortName,allCoins));},[sortName,allCoins]);useEffect(function(){if(searchText.length!==0||sortedCoins.length===0)return;setCurrentCoins(sortedCoins.slice(firstCoinsIndex,lastCoinsIndex));},[sortedCoins,searchText,firstCoinsIndex]);return/*#__PURE__*/_jsxs(\"div\",{className:\"list-page\",children:[/*#__PURE__*/_jsx(Header,{sort:sort}),/*#__PURE__*/_jsx(CoinBlock,{coins:currentCoins,rate:rate}),/*#__PURE__*/_jsx(Pagination,{totalPages:totalPages,pagination:pagination})]});}export default ListPage;","map":{"version":3,"sources":["C:/Users/mrgil/OneDrive/Рабочий стол/Coincap/Coin/src/Main/Pages/ListPage.jsx"],"names":["React","useEffect","useState","CoinBlock","Header","Pagination","sortCoins","getInfo","ListPage","searchText","coinsPerPage","rate","currentPage","setCurrentPage","currentCoins","setCurrentCoins","totalCoins","setTotalCoins","time","setTime","totalPages","setTotalPages","sortName","setSortName","allCoins","setAllCoins","sortedCoins","setSortedCoins","pagination","pageNamber","sort","name","firstCoinsIndex","lastCoinsIndex","update","prevTime","setTimeout","Math","ceil","getAllCoins","response","getCoins","length","responseCount","slice"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport CoinBlock from '../../Components/ListPageComponents/CoinBlock';\r\nimport Header from '../../Components/ListPageComponents/Header';\r\nimport Pagination from '../../Components/ListPageComponents/Pagination';\r\nimport { sortCoins } from '../../utilities/sortCoins';\r\nimport getInfo from '../../API/api';\r\n\r\nfunction ListPage({ searchText, coinsPerPage, rate }) {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [currentCoins, setCurrentCoins] = useState([]);\r\n  const [totalCoins, setTotalCoins] = useState(2000);\r\n  const [time, setTime] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(200);\r\n  const [sortName, setSortName] = useState('');\r\n  const [allCoins, setAllCoins] = useState(0);\r\n  const [sortedCoins, setSortedCoins] = useState([]);\r\n\r\n  const pagination = (pageNamber) => setCurrentPage(pageNamber);\r\n\r\n  const sort = (name) => setSortName(name);\r\n\r\n  const firstCoinsIndex = (currentPage * coinsPerPage) - coinsPerPage;\r\n  const lastCoinsIndex = firstCoinsIndex + coinsPerPage;\r\n\r\n  useEffect(() => {\r\n    const update = () => {\r\n      setTime((prevTime) => prevTime + 1);\r\n      setTimeout(update, 10000);\r\n    };\r\n    update();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setTotalPages(Math.ceil(totalCoins / coinsPerPage));\r\n  }, [totalCoins, coinsPerPage]);\r\n\r\n  useEffect(() => {\r\n    const getAllCoins = async () => {\r\n      const response = await getInfo('assets/?limit=2000');\r\n      setAllCoins(response);\r\n    };\r\n    getAllCoins();\r\n  }, [time]);\r\n\r\n  useEffect(() => {\r\n    const getCoins = async () => {\r\n      let response;\r\n      if (searchText.length !== 0) {\r\n        const responseCount = await getInfo(`assets/?search=${searchText}&limit=2000`);\r\n        response = await getInfo(`assets/?offset=${firstCoinsIndex}&limit=${coinsPerPage}&search=${searchText}`);\r\n        setTotalCoins(responseCount.length);\r\n      } else {\r\n        if (sortedCoins.length !== 0) return;\r\n        response = await getInfo(`assets/?offset=${firstCoinsIndex}&limit=${coinsPerPage}`);\r\n        setTotalCoins(2000);\r\n      }\r\n      setCurrentCoins(response);\r\n    };\r\n    getCoins();\r\n  }, [coinsPerPage, time, currentPage, searchText, rate, sortedCoins.length]);\r\n\r\n  useEffect(() => {\r\n    if (sortName !== '') setSortedCoins(sortCoins(sortName, allCoins));\r\n  }, [sortName, allCoins]);\r\n\r\n  useEffect(() => {\r\n    if (searchText.length !== 0 || sortedCoins.length === 0) return;\r\n    setCurrentCoins(sortedCoins.slice(firstCoinsIndex, lastCoinsIndex));\r\n  }, [sortedCoins, searchText, firstCoinsIndex]);\r\n\r\n  return (\r\n    <div className=\"list-page\">\r\n      <Header sort={sort} />\r\n      <CoinBlock coins={currentCoins} rate={rate} />\r\n      <Pagination totalPages={totalPages} pagination={pagination} />\r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default ListPage;\r\n"]},"metadata":{},"sourceType":"module"}