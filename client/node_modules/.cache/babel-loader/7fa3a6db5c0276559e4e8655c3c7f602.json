{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\mrgil\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\Coincap\\\\Coin\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from'react';import{useQuery}from'@apollo/client';import{CoinBlock}from'./components/CoinList';import{Header}from'../BasketPage/components/Header';import{Pagination}from'./components/Pagination';import ASCImage from'../../images/down--v2.png';import DESCImage from'../../images/down--v1.png';import*as COINS from'../../query/coins';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListPage(_ref){var searchText=_ref.searchText,coinsPerPage=_ref.coinsPerPage,rate=_ref.rate;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),currentCoins=_useState4[0],setCurrentCoins=_useState4[1];var _useState5=useState(2000),_useState6=_slicedToArray(_useState5,2),totalCoins=_useState6[0],setTotalCoins=_useState6[1];var _useState7=useState(200),_useState8=_slicedToArray(_useState7,2),totalPages=_useState8[0],setTotalPages=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),sortName=_useState10[0],setSortName=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),visiblePagesFromCurrentPage=_useState12[0],setVisiblePagesFromCurrentPage=_useState12[1];var _useState13=useState(3),_useState14=_slicedToArray(_useState13,2),visiblePagesFromThеEdges=_useState14[0],setVisiblePagesFromThеEdges=_useState14[1];var _useQuery=useQuery(COINS.GET_SEARCHED_COINS,{variables:{search:searchText}}),loadingSearchedCoins=_useQuery.loading,searchedCoins=_useQuery.data;var firstCoinsIndex=currentPage*coinsPerPage-coinsPerPage;var sort=function sort(name){if(name==='Rank up')setSortName('');else setSortName(name);};var _useQuery2=useQuery(COINS.GET_CURRENT_COINS,{variables:{firstIndex:firstCoinsIndex,coinsPerPage:coinsPerPage},pollInterval:10000}),loadingCurrentCoins=_useQuery2.loading,currentCoin=_useQuery2.data;var _useQuery3=useQuery(COINS.GET_CURRENT_SEARCHED_COINS,{variables:{search:searchText,firstIndex:firstCoinsIndex,coinsPerPage:coinsPerPage},pollInterval:10000}),loadingCurrentSearchedCoins=_useQuery3.loading,currentSearchedCoins=_useQuery3.data;var _useQuery4=useQuery(COINS.GET_CURRENT_SORTED_COINS,{variables:{sortingName:sortName,firstIndex:firstCoinsIndex,coinsPerPage:coinsPerPage},pollInterval:10000}),loadingCurrentSortedCoins=_useQuery4.loading,currentSortedCoins=_useQuery4.data;var names=['Rank','Name','Price','MarketCap','wap (24Hr)','Supply','Volume (24Hr)','Change (24Hr)'];var namesForLargeScreeen=['MarketCap','wap (24Hr)','Supply','Volume (24Hr)'];var pagination=function pagination(pageNamber){return setCurrentPage(pageNamber);};var screenWidth=window.screen.width;useEffect(function(){if(screenWidth>960){setVisiblePagesFromCurrentPage(8);setVisiblePagesFromThеEdges(20);}},[screenWidth]);useEffect(function(){setTotalPages(Math.ceil(totalCoins/coinsPerPage));},[totalCoins,coinsPerPage]);useEffect(function(){var getCoins=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!searchText.length){_context.next=5;break;}if(!loadingCurrentSearchedCoins)setCurrentCoins(currentSearchedCoins.getCurrentSearchedCoins);if(!loadingSearchedCoins)setTotalCoins(searchedCoins.getSearchedCoins.length);_context.next=8;break;case 5:if(!sortName){_context.next=7;break;}return _context.abrupt(\"return\");case 7:if(!loadingCurrentCoins){setCurrentCoins(currentCoin.getCurrentCoins);setTotalCoins(2000);}case 8:case\"end\":return _context.stop();}}},_callee);}));return function getCoins(){return _ref2.apply(this,arguments);};}();getCoins();},[currentCoin,currentSearchedCoins,sortName]);useEffect(function(){if(searchText.length||!sortName)return;if(!loadingCurrentSortedCoins)setCurrentCoins(currentSortedCoins.getCurrentSortedCoins);},[currentSortedCoins,searchText]);return/*#__PURE__*/_jsxs(\"div\",{className:\"list-page\",children:[/*#__PURE__*/_jsx(Header,{sort:sort,screenWidth:screenWidth,names:names,namesForLargeScreeen:namesForLargeScreeen,ASCImage:ASCImage,DESCImage:DESCImage}),/*#__PURE__*/_jsx(CoinBlock,{coins:currentCoins,rate:rate}),/*#__PURE__*/_jsx(Pagination,{totalPages:totalPages,visiblePagesFromCurrentPage:visiblePagesFromCurrentPage,visiblePagesFromThеEdges:visiblePagesFromThеEdges,pagination:pagination})]});}export default ListPage;","map":{"version":3,"sources":["C:/Users/mrgil/OneDrive/Рабочий стол/Coincap/Coin/client/src/Main/LitsPage/CoinsPage.jsx"],"names":["React","useEffect","useState","useQuery","CoinBlock","Header","Pagination","ASCImage","DESCImage","COINS","ListPage","searchText","coinsPerPage","rate","currentPage","setCurrentPage","currentCoins","setCurrentCoins","totalCoins","setTotalCoins","totalPages","setTotalPages","sortName","setSortName","visiblePagesFromCurrentPage","setVisiblePagesFromCurrentPage","visiblePagesFromThеEdges","setVisiblePagesFromThеEdges","GET_SEARCHED_COINS","variables","search","loadingSearchedCoins","loading","searchedCoins","data","firstCoinsIndex","sort","name","GET_CURRENT_COINS","firstIndex","pollInterval","loadingCurrentCoins","currentCoin","GET_CURRENT_SEARCHED_COINS","loadingCurrentSearchedCoins","currentSearchedCoins","GET_CURRENT_SORTED_COINS","sortingName","loadingCurrentSortedCoins","currentSortedCoins","names","namesForLargeScreeen","pagination","pageNamber","screenWidth","window","screen","width","Math","ceil","getCoins","length","getCurrentSearchedCoins","getSearchedCoins","getCurrentCoins","getCurrentSortedCoins"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useQuery } from '@apollo/client';\r\nimport { CoinBlock } from './components/CoinList';\r\nimport { Header } from '../BasketPage/components/Header';\r\nimport { Pagination } from './components/Pagination';\r\nimport ASCImage from '../../images/down--v2.png';\r\nimport DESCImage from '../../images/down--v1.png';\r\nimport * as COINS from '../../query/coins';\r\n\r\nfunction ListPage({ searchText, coinsPerPage, rate }) {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [currentCoins, setCurrentCoins] = useState([]);\r\n  const [totalCoins, setTotalCoins] = useState(2000);\r\n  const [totalPages, setTotalPages] = useState(200);\r\n  const [sortName, setSortName] = useState('');\r\n  const [visiblePagesFromCurrentPage, setVisiblePagesFromCurrentPage] = useState(1);\r\n  const [visiblePagesFromThеEdges, setVisiblePagesFromThеEdges] = useState(3);\r\n  const { loading: loadingSearchedCoins, data: searchedCoins } = useQuery(COINS.GET_SEARCHED_COINS, {\r\n    variables: {\r\n      search: searchText,\r\n    },\r\n  });\r\n\r\n  const firstCoinsIndex = (currentPage * coinsPerPage) - coinsPerPage;\r\n\r\n  const sort = (name) => {\r\n    if (name === 'Rank up') setSortName('');\r\n    else setSortName(name);\r\n  };\r\n\r\n  const { loading: loadingCurrentCoins, data: currentCoin } = useQuery(COINS.GET_CURRENT_COINS, {\r\n    variables: {\r\n      firstIndex: firstCoinsIndex,\r\n      coinsPerPage,\r\n    },\r\n    pollInterval: 10000,\r\n  });\r\n  const { loading: loadingCurrentSearchedCoins, data: currentSearchedCoins } = useQuery(COINS.GET_CURRENT_SEARCHED_COINS, {\r\n    variables: {\r\n      search: searchText,\r\n      firstIndex: firstCoinsIndex,\r\n      coinsPerPage,\r\n    },\r\n    pollInterval: 10000,\r\n  });\r\n  const { loading: loadingCurrentSortedCoins, data: currentSortedCoins } = useQuery(COINS.GET_CURRENT_SORTED_COINS, {\r\n    variables: {\r\n      sortingName: sortName,\r\n      firstIndex: firstCoinsIndex,\r\n      coinsPerPage,\r\n    },\r\n    pollInterval: 10000,\r\n  });\r\n\r\n  const names = ['Rank', 'Name', 'Price', 'MarketCap', 'wap (24Hr)', 'Supply', 'Volume (24Hr)', 'Change (24Hr)'];\r\n  const namesForLargeScreeen = ['MarketCap', 'wap (24Hr)', 'Supply', 'Volume (24Hr)'];\r\n\r\n  const pagination = (pageNamber) => setCurrentPage(pageNamber);\r\n\r\n  const screenWidth = window.screen.width;\r\n\r\n  useEffect(() => {\r\n    if (screenWidth > 960) {\r\n      setVisiblePagesFromCurrentPage(8);\r\n      setVisiblePagesFromThеEdges(20);\r\n    }\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    setTotalPages(Math.ceil(totalCoins / coinsPerPage));\r\n  }, [totalCoins, coinsPerPage]);\r\n\r\n  useEffect(() => {\r\n    const getCoins = async () => {\r\n      if (searchText.length) {\r\n        if (!loadingCurrentSearchedCoins) setCurrentCoins(currentSearchedCoins.getCurrentSearchedCoins);\r\n        if (!loadingSearchedCoins) setTotalCoins(searchedCoins.getSearchedCoins.length);\r\n      } else {\r\n        if (sortName) return;\r\n        if (!loadingCurrentCoins) {\r\n          setCurrentCoins(currentCoin.getCurrentCoins);\r\n          setTotalCoins(2000);\r\n        }\r\n      }\r\n    };\r\n    getCoins();\r\n  }, [currentCoin, currentSearchedCoins, sortName]);\r\n\r\n  useEffect(() => {\r\n    if (searchText.length || !sortName) return;\r\n    if (!loadingCurrentSortedCoins) setCurrentCoins(currentSortedCoins.getCurrentSortedCoins);\r\n  }, [currentSortedCoins, searchText]);\r\n\r\n  return (\r\n    <div className=\"list-page\">\r\n      <Header\r\n        sort={sort}\r\n        screenWidth={screenWidth}\r\n        names={names}\r\n        namesForLargeScreeen={namesForLargeScreeen}\r\n        ASCImage={ASCImage}\r\n        DESCImage={DESCImage}\r\n      />\r\n      <CoinBlock coins={currentCoins} rate={rate} />\r\n      <Pagination\r\n        totalPages={totalPages}\r\n        visiblePagesFromCurrentPage={visiblePagesFromCurrentPage}\r\n        visiblePagesFromThеEdges={visiblePagesFromThеEdges}\r\n        pagination={pagination}\r\n      />\r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default ListPage;\r\n"]},"metadata":{},"sourceType":"module"}