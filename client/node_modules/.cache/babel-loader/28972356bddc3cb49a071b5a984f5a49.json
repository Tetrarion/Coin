{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mrgil/OneDrive/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/Coincap/Coin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\mrgil\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\Coincap\\\\Coin\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from'react';import{CoinBlock}from'./components/CoinList';import{Header}from'../BasketPage/components/Header';import{Pagination}from'./components/Pagination';import{sortCoins}from'../../utilities/sortCoins';import getInfo from'../../API/api';import ASCImage from'../../images/down--v2.png';import DESCImage from'../../images/down--v1.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListPage(_ref){var searchText=_ref.searchText,coinsPerPage=_ref.coinsPerPage,rate=_ref.rate;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),currentCoins=_useState4[0],setCurrentCoins=_useState4[1];var _useState5=useState(2000),_useState6=_slicedToArray(_useState5,2),totalCoins=_useState6[0],setTotalCoins=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),time=_useState8[0],setTime=_useState8[1];var _useState9=useState(200),_useState10=_slicedToArray(_useState9,2),totalPages=_useState10[0],setTotalPages=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),sortName=_useState12[0],setSortName=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),allCoins=_useState14[0],setAllCoins=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),sortedCoins=_useState16[0],setSortedCoins=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),visiblePagesFromCurrentPage=_useState18[0],setVisiblePagesFromCurrentPage=_useState18[1];var _useState19=useState(3),_useState20=_slicedToArray(_useState19,2),visiblePagesFromThеEdges=_useState20[0],setVisiblePagesFromThеEdges=_useState20[1];var names=['Rank','Name','Price','MarketCap','wap (24Hr)','Supply','Volume (24Hr)','Change (24Hr)'];var namesForLargeScreeen=['MarketCap','wap (24Hr)','Supply','Volume (24Hr)'];var pagination=function pagination(pageNamber){return setCurrentPage(pageNamber);};var sort=function sort(name){return setSortName(name);};var firstCoinsIndex=currentPage*coinsPerPage-coinsPerPage;var lastCoinsIndex=firstCoinsIndex+coinsPerPage;var screenWidth=window.screen.width;useEffect(function(){if(screenWidth>960){setVisiblePagesFromCurrentPage(8);setVisiblePagesFromThеEdges(20);}},[screenWidth]);useEffect(function(){var update=function update(){setTime(function(prevTime){return prevTime+1;});setTimeout(update,10000);};update();},[]);useEffect(function(){setTotalPages(Math.ceil(totalCoins/coinsPerPage));},[totalCoins,coinsPerPage]);useEffect(function(){var getAllCoins=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getInfo('assets/?limit=2000');case 2:response=_context.sent;setAllCoins(response);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getAllCoins(){return _ref2.apply(this,arguments);};}();getAllCoins();},[time]);useEffect(function(){var getCoins=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,responseCount;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!searchText.length){_context2.next=10;break;}_context2.next=3;return getInfo(\"assets/?search=\".concat(searchText,\"&limit=2000\"));case 3:responseCount=_context2.sent;_context2.next=6;return getInfo(\"assets/?offset=\".concat(firstCoinsIndex,\"&limit=\").concat(coinsPerPage,\"&search=\").concat(searchText));case 6:response=_context2.sent;setTotalCoins(responseCount.length);_context2.next=16;break;case 10:if(!sortedCoins.length){_context2.next=12;break;}return _context2.abrupt(\"return\");case 12:_context2.next=14;return getInfo(\"assets/?offset=\".concat(firstCoinsIndex,\"&limit=\").concat(coinsPerPage));case 14:response=_context2.sent;setTotalCoins(2000);case 16:setCurrentCoins(response);case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function getCoins(){return _ref3.apply(this,arguments);};}();getCoins();},[coinsPerPage,time,currentPage,searchText,rate,sortedCoins.length,firstCoinsIndex]);useEffect(function(){if(sortName)setSortedCoins(sortCoins(sortName,allCoins));},[sortName,allCoins]);useEffect(function(){if(searchText.length||!sortedCoins.length)return;setCurrentCoins(sortedCoins.slice(firstCoinsIndex,lastCoinsIndex));},[sortedCoins,searchText,firstCoinsIndex,lastCoinsIndex]);return/*#__PURE__*/_jsxs(\"div\",{className:\"list-page\",children:[/*#__PURE__*/_jsx(Header,{sort:sort,screenWidth:screenWidth,names:names,namesForLargeScreeen:namesForLargeScreeen,ASCImage:ASCImage,DESCImage:DESCImage}),/*#__PURE__*/_jsx(CoinBlock,{coins:currentCoins,rate:rate}),/*#__PURE__*/_jsx(Pagination,{totalPages:totalPages,visiblePagesFromCurrentPage:visiblePagesFromCurrentPage,visiblePagesFromThеEdges:visiblePagesFromThеEdges,pagination:pagination})]});}export default ListPage;","map":{"version":3,"sources":["C:/Users/mrgil/OneDrive/Рабочий стол/Coincap/Coin/src/Main/LitsPage/CoinsPage.jsx"],"names":["React","useEffect","useState","CoinBlock","Header","Pagination","sortCoins","getInfo","ASCImage","DESCImage","ListPage","searchText","coinsPerPage","rate","currentPage","setCurrentPage","currentCoins","setCurrentCoins","totalCoins","setTotalCoins","time","setTime","totalPages","setTotalPages","sortName","setSortName","allCoins","setAllCoins","sortedCoins","setSortedCoins","visiblePagesFromCurrentPage","setVisiblePagesFromCurrentPage","visiblePagesFromThеEdges","setVisiblePagesFromThеEdges","names","namesForLargeScreeen","pagination","pageNamber","sort","name","firstCoinsIndex","lastCoinsIndex","screenWidth","window","screen","width","update","prevTime","setTimeout","Math","ceil","getAllCoins","response","getCoins","length","responseCount","slice"],"mappings":"wkBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,SAAT,KAA0B,uBAA1B,CACA,OAASC,MAAT,KAAuB,iCAAvB,CACA,OAASC,UAAT,KAA2B,yBAA3B,CACA,OAASC,SAAT,KAA0B,2BAA1B,CACA,MAAOC,CAAAA,OAAP,KAAoB,eAApB,CACA,MAAOC,CAAAA,QAAP,KAAqB,2BAArB,CACA,MAAOC,CAAAA,SAAP,KAAsB,2BAAtB,C,wFAEA,QAASC,CAAAA,QAAT,MAAsD,IAAlCC,CAAAA,UAAkC,MAAlCA,UAAkC,CAAtBC,YAAsB,MAAtBA,YAAsB,CAARC,IAAQ,MAARA,IAAQ,CACpD,cAAsCX,QAAQ,CAAC,CAAD,CAA9C,wCAAOY,WAAP,eAAoBC,cAApB,eACA,eAAwCb,QAAQ,CAAC,EAAD,CAAhD,yCAAOc,YAAP,eAAqBC,eAArB,eACA,eAAoCf,QAAQ,CAAC,IAAD,CAA5C,yCAAOgB,UAAP,eAAmBC,aAAnB,eACA,eAAwBjB,QAAQ,CAAC,CAAD,CAAhC,yCAAOkB,IAAP,eAAaC,OAAb,eACA,eAAoCnB,QAAQ,CAAC,GAAD,CAA5C,0CAAOoB,UAAP,gBAAmBC,aAAnB,gBACA,gBAAgCrB,QAAQ,CAAC,EAAD,CAAxC,2CAAOsB,QAAP,gBAAiBC,WAAjB,gBACA,gBAAgCvB,QAAQ,CAAC,CAAD,CAAxC,2CAAOwB,QAAP,gBAAiBC,WAAjB,gBACA,gBAAsCzB,QAAQ,CAAC,EAAD,CAA9C,2CAAO0B,WAAP,gBAAoBC,cAApB,gBACA,gBAAsE3B,QAAQ,CAAC,CAAD,CAA9E,2CAAO4B,2BAAP,gBAAoCC,8BAApC,gBACA,gBAAgE7B,QAAQ,CAAC,CAAD,CAAxE,2CAAO8B,wBAAP,gBAAiCC,2BAAjC,gBAEA,GAAMC,CAAAA,KAAK,CAAG,CAAC,MAAD,CAAS,MAAT,CAAiB,OAAjB,CAA0B,WAA1B,CAAuC,YAAvC,CAAqD,QAArD,CAA+D,eAA/D,CAAgF,eAAhF,CAAd,CACA,GAAMC,CAAAA,oBAAoB,CAAG,CAAC,WAAD,CAAc,YAAd,CAA4B,QAA5B,CAAsC,eAAtC,CAA7B,CAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,UAAD,QAAgBtB,CAAAA,cAAc,CAACsB,UAAD,CAA9B,EAAnB,CAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,CAACC,IAAD,QAAUd,CAAAA,WAAW,CAACc,IAAD,CAArB,EAAb,CAEA,GAAMC,CAAAA,eAAe,CAAI1B,WAAW,CAAGF,YAAf,CAA+BA,YAAvD,CACA,GAAM6B,CAAAA,cAAc,CAAGD,eAAe,CAAG5B,YAAzC,CAEA,GAAM8B,CAAAA,WAAW,CAAGC,MAAM,CAACC,MAAP,CAAcC,KAAlC,CAEA5C,SAAS,CAAC,UAAM,CACd,GAAIyC,WAAW,CAAG,GAAlB,CAAuB,CACrBX,8BAA8B,CAAC,CAAD,CAA9B,CACAE,2BAA2B,CAAC,EAAD,CAA3B,CACD,CACF,CALQ,CAKN,CAACS,WAAD,CALM,CAAT,CAOAzC,SAAS,CAAC,UAAM,CACd,GAAM6C,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACnBzB,OAAO,CAAC,SAAC0B,QAAD,QAAcA,CAAAA,QAAQ,CAAG,CAAzB,EAAD,CAAP,CACAC,UAAU,CAACF,MAAD,CAAS,KAAT,CAAV,CACD,CAHD,CAIAA,MAAM,GACP,CANQ,CAMN,EANM,CAAT,CAQA7C,SAAS,CAAC,UAAM,CACdsB,aAAa,CAAC0B,IAAI,CAACC,IAAL,CAAUhC,UAAU,CAAGN,YAAvB,CAAD,CAAb,CACD,CAFQ,CAEN,CAACM,UAAD,CAAaN,YAAb,CAFM,CAAT,CAIAX,SAAS,CAAC,UAAM,CACd,GAAMkD,CAAAA,WAAW,2FAAG,sKACK5C,CAAAA,OAAO,CAAC,oBAAD,CADZ,QACZ6C,QADY,eAElBzB,WAAW,CAACyB,QAAD,CAAX,CAFkB,sDAAH,kBAAXD,CAAAA,WAAW,2CAAjB,CAIAA,WAAW,GACZ,CANQ,CAMN,CAAC/B,IAAD,CANM,CAAT,CAQAnB,SAAS,CAAC,UAAM,CACd,GAAMoD,CAAAA,QAAQ,2FAAG,uKAEX1C,UAAU,CAAC2C,MAFA,kDAGe/C,CAAAA,OAAO,0BAAmBI,UAAnB,gBAHtB,QAGP4C,aAHO,uCAIIhD,CAAAA,OAAO,0BAAmBiC,eAAnB,mBAA4C5B,YAA5C,oBAAmED,UAAnE,EAJX,QAIbyC,QAJa,gBAKbjC,aAAa,CAACoC,aAAa,CAACD,MAAf,CAAb,CALa,oCAOT1B,WAAW,CAAC0B,MAPH,6FAQI/C,CAAAA,OAAO,0BAAmBiC,eAAnB,mBAA4C5B,YAA5C,EARX,SAQbwC,QARa,gBASbjC,aAAa,CAAC,IAAD,CAAb,CATa,QAWfF,eAAe,CAACmC,QAAD,CAAf,CAXe,yDAAH,kBAARC,CAAAA,QAAQ,2CAAd,CAaAA,QAAQ,GACT,CAfQ,CAeN,CAACzC,YAAD,CAAeQ,IAAf,CAAqBN,WAArB,CAAkCH,UAAlC,CAA8CE,IAA9C,CAAoDe,WAAW,CAAC0B,MAAhE,CAAwEd,eAAxE,CAfM,CAAT,CAiBAvC,SAAS,CAAC,UAAM,CACd,GAAIuB,QAAJ,CAAcK,cAAc,CAACvB,SAAS,CAACkB,QAAD,CAAWE,QAAX,CAAV,CAAd,CACf,CAFQ,CAEN,CAACF,QAAD,CAAWE,QAAX,CAFM,CAAT,CAIAzB,SAAS,CAAC,UAAM,CACd,GAAIU,UAAU,CAAC2C,MAAX,EAAqB,CAAC1B,WAAW,CAAC0B,MAAtC,CAA8C,OAC9CrC,eAAe,CAACW,WAAW,CAAC4B,KAAZ,CAAkBhB,eAAlB,CAAmCC,cAAnC,CAAD,CAAf,CACD,CAHQ,CAGN,CAACb,WAAD,CAAcjB,UAAd,CAA0B6B,eAA1B,CAA2CC,cAA3C,CAHM,CAAT,CAKA,mBACE,aAAK,SAAS,CAAC,WAAf,wBACE,KAAC,MAAD,EACE,IAAI,CAAEH,IADR,CAEE,WAAW,CAAEI,WAFf,CAGE,KAAK,CAAER,KAHT,CAIE,oBAAoB,CAAEC,oBAJxB,CAKE,QAAQ,CAAE3B,QALZ,CAME,SAAS,CAAEC,SANb,EADF,cASE,KAAC,SAAD,EAAW,KAAK,CAAEO,YAAlB,CAAgC,IAAI,CAAEH,IAAtC,EATF,cAUE,KAAC,UAAD,EACE,UAAU,CAAES,UADd,CAEE,2BAA2B,CAAEQ,2BAF/B,CAGE,wBAAwB,CAAEE,wBAH5B,CAIE,UAAU,CAAEI,UAJd,EAVF,GADF,CAoBD,CAED,cAAe1B,CAAAA,QAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { CoinBlock } from './components/CoinList';\r\nimport { Header } from '../BasketPage/components/Header';\r\nimport { Pagination } from './components/Pagination';\r\nimport { sortCoins } from '../../utilities/sortCoins';\r\nimport getInfo from '../../API/api';\r\nimport ASCImage from '../../images/down--v2.png';\r\nimport DESCImage from '../../images/down--v1.png';\r\n\r\nfunction ListPage({ searchText, coinsPerPage, rate }) {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [currentCoins, setCurrentCoins] = useState([]);\r\n  const [totalCoins, setTotalCoins] = useState(2000);\r\n  const [time, setTime] = useState(0);\r\n  const [totalPages, setTotalPages] = useState(200);\r\n  const [sortName, setSortName] = useState('');\r\n  const [allCoins, setAllCoins] = useState(0);\r\n  const [sortedCoins, setSortedCoins] = useState([]);\r\n  const [visiblePagesFromCurrentPage, setVisiblePagesFromCurrentPage] = useState(1);\r\n  const [visiblePagesFromThеEdges, setVisiblePagesFromThеEdges] = useState(3);\r\n\r\n  const names = ['Rank', 'Name', 'Price', 'MarketCap', 'wap (24Hr)', 'Supply', 'Volume (24Hr)', 'Change (24Hr)'];\r\n  const namesForLargeScreeen = ['MarketCap', 'wap (24Hr)', 'Supply', 'Volume (24Hr)'];\r\n\r\n  const pagination = (pageNamber) => setCurrentPage(pageNamber);\r\n\r\n  const sort = (name) => setSortName(name);\r\n\r\n  const firstCoinsIndex = (currentPage * coinsPerPage) - coinsPerPage;\r\n  const lastCoinsIndex = firstCoinsIndex + coinsPerPage;\r\n\r\n  const screenWidth = window.screen.width;\r\n\r\n  useEffect(() => {\r\n    if (screenWidth > 960) {\r\n      setVisiblePagesFromCurrentPage(8);\r\n      setVisiblePagesFromThеEdges(20);\r\n    }\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    const update = () => {\r\n      setTime((prevTime) => prevTime + 1);\r\n      setTimeout(update, 10000);\r\n    };\r\n    update();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setTotalPages(Math.ceil(totalCoins / coinsPerPage));\r\n  }, [totalCoins, coinsPerPage]);\r\n\r\n  useEffect(() => {\r\n    const getAllCoins = async () => {\r\n      const response = await getInfo('assets/?limit=2000');\r\n      setAllCoins(response);\r\n    };\r\n    getAllCoins();\r\n  }, [time]);\r\n\r\n  useEffect(() => {\r\n    const getCoins = async () => {\r\n      let response;\r\n      if (searchText.length) {\r\n        const responseCount = await getInfo(`assets/?search=${searchText}&limit=2000`);\r\n        response = await getInfo(`assets/?offset=${firstCoinsIndex}&limit=${coinsPerPage}&search=${searchText}`);\r\n        setTotalCoins(responseCount.length);\r\n      } else {\r\n        if (sortedCoins.length) return;\r\n        response = await getInfo(`assets/?offset=${firstCoinsIndex}&limit=${coinsPerPage}`);\r\n        setTotalCoins(2000);\r\n      }\r\n      setCurrentCoins(response);\r\n    };\r\n    getCoins();\r\n  }, [coinsPerPage, time, currentPage, searchText, rate, sortedCoins.length, firstCoinsIndex]);\r\n\r\n  useEffect(() => {\r\n    if (sortName) setSortedCoins(sortCoins(sortName, allCoins));\r\n  }, [sortName, allCoins]);\r\n\r\n  useEffect(() => {\r\n    if (searchText.length || !sortedCoins.length) return;\r\n    setCurrentCoins(sortedCoins.slice(firstCoinsIndex, lastCoinsIndex));\r\n  }, [sortedCoins, searchText, firstCoinsIndex, lastCoinsIndex]);\r\n\r\n  return (\r\n    <div className=\"list-page\">\r\n      <Header\r\n        sort={sort}\r\n        screenWidth={screenWidth}\r\n        names={names}\r\n        namesForLargeScreeen={namesForLargeScreeen}\r\n        ASCImage={ASCImage}\r\n        DESCImage={DESCImage}\r\n      />\r\n      <CoinBlock coins={currentCoins} rate={rate} />\r\n      <Pagination\r\n        totalPages={totalPages}\r\n        visiblePagesFromCurrentPage={visiblePagesFromCurrentPage}\r\n        visiblePagesFromThеEdges={visiblePagesFromThеEdges}\r\n        pagination={pagination}\r\n      />\r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default ListPage;\r\n"]},"metadata":{},"sourceType":"module"}